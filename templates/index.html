<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TriAI Compare - Multi-AI Response Comparison</title>
    <meta name="description" content="Compare responses from OpenAI, Anthropic, Google, and Perplexity AI side-by-side">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/history_video.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/role_selectors.css') }}">
    <style>
        .sandbag-badge {
            background: rgba(255, 165, 0, 0.1);
            color: #ffa500;
            border: 1px solid rgba(255, 165, 0, 0.3);
            font-size: 0.75rem;
            padding: 2px 8px;
            border-radius: 4px;
            margin-left: 10px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 0.7;
            }

            50% {
                opacity: 1;
                transform: scale(1.05);
            }

            100% {
                opacity: 0.7;
            }
        }

        .sandbag-badge.hidden {
            display: none;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
</head>

<body>
    <!-- Background Video Container -->
    <div class="bg-video-container">
        <!-- Idle State (Low Energy) -->
        <video id="bgVideo" class="video-layer active" autoplay muted loop playsinline>
            <source src="{{ url_for('static', filename='videos/background_main.mp4') }}" type="video/mp4">
        </video>

        <!-- Processing State (High Energy) -->
        <video id="processingVideo" class="video-layer" muted loop playsinline>
            <source src="{{ url_for('static', filename='videos/processing_gold_final.mp4') }}" type="video/mp4">
        </video>
    </div>

    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1 class="logo">
                    <span class="logo-tri">Tri</span><span class="logo-ai">AI</span>
                    <span class="logo-subtitle">Compare</span>
                </h1>
                <p class="tagline">Ask once. Compare four perspectives.</p>
                <div id="currentProjectDisplay" class="current-project-display hidden">
                    <span class="label">Project:</span>
                    <span class="value" id="currentProjectName">None</span>
                    <button id="clearProject" class="clear-project-btn" title="Exit Project">√ó</button>
                </div>
            </div>

            <!-- Navbar -->
            <div class="navbar">
                <button id="projectsToggle" class="nav-btn">
                    <span class="icon">üìÇ</span> Projects
                </button>
                <button id="historyToggle" class="nav-btn">
                    <span class="icon">üìú</span> History
                </button>
                <a href="/dashboard" class="nav-btn">
                    <span class="icon">üìä</span> Learning
                </a>
            </div>
        </header>

        <!-- Projects Sidebar -->
        <aside id="projectsSidebar" class="sidebar left-sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">Projects</h2>
                <button id="closeProjects" class="close-sidebar">√ó</button>
            </div>
            <div class="projects-content">
                <div class="create-project-form">
                    <input type="text" id="newProjectInput" placeholder="New Project Name...">
                    <button id="createProjectBtn">+</button>
                </div>
                <div id="projectsList" class="projects-list">
                    <!-- Project items will be injected here -->
                    <div class="loading-text">Loading projects...</div>
                </div>
            </div>
        </aside>

        <!-- History Sidebar -->
        <aside id="historySidebar" class="sidebar right-sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title">History</h2>
                <button id="closeHistory" class="close-sidebar">√ó</button>
            </div>
            <div id="historyList" class="history-list">
                <!-- History items will be injected here -->
                <div class="loading-history">Loading...</div>
            </div>
        </aside>

        <!-- Input Section -->
        <section class="input-section">
            <div class="input-container">
                <textarea id="questionInput"
                    placeholder="Enter your question here... (e.g., 'Explain quantum computing in simple terms')"
                    rows="4"></textarea>
                <div class="file-upload-area" id="fileUploadArea">
                    <input type="file" id="fileInput" hidden multiple
                        accept=".txt,.pdf,.md,.csv,.json,.py,.js,.html,.css,.png,.jpg,.jpeg,.webp">
                    <div class="upload-placeholder">
                        <span class="upload-icon">üìÅ</span>
                        <span class="upload-text">Drag file or click to upload context (PDF, Img, Code)</span>
                    </div>
                    <div class="file-preview hidden" id="filePreview">
                        <span class="file-name">example.pdf</span>
                        <button class="remove-file">√ó</button>
                    </div>
                </div>

                <!-- Active Models Section -->
                <div class="model-selection-area">
                    <span class="section-label">ACTIVE MODELS:</span>
                    <div class="model-toggles">
                        <button class="model-toggle active" data-model="openai">
                            <span class="status-icon">‚úì</span> GPT-5.2
                        </button>
                        <button class="model-toggle active" data-model="anthropic">
                            <span class="status-icon">‚úì</span> Claude S4
                        </button>
                        <button class="model-toggle active" data-model="google">
                            <span class="status-icon">‚úì</span> Gemini 3.0
                        </button>
                        <button class="model-toggle active" data-model="perplexity">
                            <span class="status-icon">‚úì</span> Perplexity
                        </button>
                    </div>
                </div>

                <!-- Council Role Selectors (shown when Council Mode is ON) -->
                <div id="roleSelectors" class="role-selectors hidden">
                    <!-- Recommendation UI -->
                    <div id="roleRecommendation" class="recommended-council-box hidden">
                        <div class="rec-header">
                            <span class="rec-icon">üèõÔ∏è</span>
                            <div class="rec-text">
                                <span class="rec-label">Query detected:</span>
                                <span id="detectedCategory" class="rec-category">Analyzing...</span>
                            </div>
                        </div>
                        <div class="rec-suggestion">
                            <p>Recommended Council configuration:</p>
                            <ul id="recommendedRolesList">
                                <!-- Roles will be injected here -->
                            </ul>
                            <div class="rec-meta">
                                This configuration has <span id="recRating">--</span> avg rating
                            </div>
                        </div>
                        <div class="rec-actions">
                            <button id="useRecommendedBtn" class="rec-btn primary">Use Recommended</button>
                            <button id="customizeRolesBtn" class="rec-btn secondary">Customize</button>
                        </div>
                    </div>

                    <div class="role-selector-header">
                        <span class="roles-title">üèõÔ∏è Assign Council Roles:</span>
                    </div>
                    <div class="role-selector-grid">
                        <div class="role-assignment">
                            <label class="role-label">OpenAI (GPT-5.2):</label>
                            <select id="roleOpenAI" class="role-dropdown">
                                {% for key, role in roles.items() %}
                                <option value="{{ key }}" {% if defaults.openai==key %}selected{% endif %}>
                                    {{ role.icon }} {{ role.name }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="role-assignment">
                            <label class="role-label">Anthropic (Claude):</label>
                            <select id="roleAnthropic" class="role-dropdown">
                                {% for key, role in roles.items() %}
                                <option value="{{ key }}" {% if defaults.anthropic==key %}selected{% endif %}>
                                    {{ role.icon }} {{ role.name }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="role-assignment">
                            <label class="role-label">Google (Gemini):</label>
                            <select id="roleGoogle" class="role-dropdown">
                                {% for key, role in roles.items() %}
                                <option value="{{ key }}" {% if defaults.google==key %}selected{% endif %}>
                                    {{ role.icon }} {{ role.name }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="role-assignment">
                            <label class="role-label">Perplexity:</label>
                            <select id="rolePerplexity" class="role-dropdown">
                                {% for key, role in roles.items() %}
                                <option value="{{ key }}" {% if defaults.perplexity==key %}selected{% endif %}>
                                    {{ role.icon }} {{ role.name }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>

                <div class="input-actions">
                    <div class="switch-group">
                        <label class="toggle-switch">
                            <input type="checkbox" id="vaultToggle">
                            <span class="slider round"></span>
                            <span class="toggle-label">Vault Context</span>
                        </label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="citationToggle">
                            <span class="slider round"></span>
                            <span class="toggle-label">Citations</span>
                        </label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="thoughtToggle">
                            <span class="slider round"></span>
                            <span class="toggle-label">Thoughts</span>
                        </label>
                        <label class="toggle-switch">
                            <input type="checkbox" id="podcastToggle">
                            <span class="slider round"></span>
                            <span class="toggle-label">Podcast Mode</span>
                        </label>
                        <label class="toggle-switch council-switch">
                            <input type="checkbox" id="councilToggle">
                            <span class="slider round"></span>
                            <span class="toggle-label">Council üèõÔ∏è</span>
                        </label>
                        <label class="toggle-switch" title="Total Persona Lockdown: 100% Rejection of Generic Fillers">
                            <input type="checkbox" id="hardModeToggle">
                            <span class="slider round"></span>
                            <span class="toggle-label">Hard Mode ‚ö°</span>
                        </label>
                    </div>

                    <button id="micBtn" class="icon-button" title="Voice Input">
                        üé§
                    </button>
                    <button id="askButton" class="ask-button">
                        <span class="button-text">Ask All AIs</span>
                        <span class="button-icon">‚Üí</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Mermaid for Charts -->
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({ startOnLoad: false, theme: 'dark' });</script>

        <!-- Loading State -->
        <div id="loadingState" class="loading-state hidden">
            <div class="loading-spinner"></div>
            <p id="loadingStatusText">Querying models...</p>
        </div>

        <!-- Consensus Section -->
        <section id="consensusSection" class="consensus-section hidden">
            <div class="consensus-card">
                <h3>ü§ñ AI Consensus Analysis</h3>
                <div id="consensusContent" class="consensus-content">
                    Loading analysis...
                </div>
                <div class="consensus-actions">
                    <button id="listenBtn" class="action-btn" title="Read Aloud">
                        <span class="icon">üîä</span> Listen
                    </button>
                    <button id="obsidianBtn" class="action-btn" title="Save to Obsidian Vault">
                        <span class="icon">üíæ</span> Save to Vault
                    </button>
                    <button id="exportBtn" class="action-btn" title="Download Markdown Report">
                        <span class="icon">‚¨áÔ∏è</span> Export Report
                    </button>
                </div>

                <!-- Feedback Square -->
                <div id="feedbackSquare" class="feedback-square hidden">
                    <div class="feedback-header">
                        <h4>‚≠ê How helpful was this analysis?</h4>
                    </div>
                    <div class="rating-options">
                        <button class="rating-btn" data-rating="1" title="Not Helpful">üòû</button>
                        <button class="rating-btn" data-rating="2" title="Okay">üòê</button>
                        <button class="rating-btn" data-rating="3" title="Helpful">üòä</button>
                        <button class="rating-btn" data-rating="4" title="Excellent">ü§©</button>
                    </div>
                    <div class="feedback-issues">
                        <label class="issue-item">
                            <input type="checkbox" name="too_generic">
                            <span class="checkbox-custom"></span> Response was too generic
                        </label>
                        <label class="issue-item">
                            <input type="checkbox" name="missing_details">
                            <span class="checkbox-custom"></span> Missing technical details
                        </label>
                        <label class="issue-item">
                            <input type="checkbox" name="wrong_roles">
                            <span class="checkbox-custom"></span> Wrong role assignments
                        </label>
                        <label class="issue-item">
                            <input type="checkbox" name="didnt_answer">
                            <span class="checkbox-custom"></span> Didn't answer my question
                        </label>
                    </div>
                    <div class="feedback-comment">
                        <textarea id="feedbackText" placeholder="Optional: Add specific feedback..."></textarea>
                    </div>
                    <button id="submitFeedbackBtn" class="submit-feedback-btn">Submit Feedback</button>
                    <div id="feedbackThanks" class="feedback-thanks hidden">
                        <p>‚ú® Thank you for your feedback!</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Results Grid -->
        <section id="resultsSection" class="results-section hidden">
            <div class="results-grid">
                <!-- OpenAI Response -->
                <div class="ai-card" data-ai="openai">
                    <div class="ai-header">
                        <div class="ai-info">
                            <h2 class="ai-name">OpenAI</h2>
                            <span class="ai-model" id="openai-model">GPT-4o</span>
                            <span class="sandbag-badge hidden" id="openai-sandbag"
                                title="Heavy reasoning detected in thoughts. The good stuff might be hidden!">üõ∏
                                Sandbagging?</span>
                            <span class="bias-badge hidden" id="openai-bias"></span>
                        </div>
                        <div class="card-rating" data-ai="openai">
                            <button class="card-rate-btn up" title="Helpful answer">üëç</button>
                            <button class="card-rate-btn down" title="Generic or unhelpful">üëé</button>
                        </div>
                        <div class="ai-meta">
                            <span class="cost-tag" id="openai-cost">$0.000</span>
                            <span class="response-time" id="openai-time">-- s</span>
                            <button class="copy-button" data-target="openai">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path
                                        d="M13.5 5.5H6.5C5.67157 5.5 5 6.17157 5 7V14C5 14.8284 5.67157 15.5 6.5 15.5H13.5C14.3284 15.5 15 14.8284 15 14V7C15 6.17157 14.3284 5.5 13.5 5.5Z"
                                        stroke="currentColor" stroke-width="1.5" />
                                    <path
                                        d="M3 10.5H2.5C1.67157 10.5 1 9.82843 1 9V2C1 1.17157 1.67157 0.5 2.5 0.5H9.5C10.3284 0.5 11 1.17157 11 2V2.5"
                                        stroke="currentColor" stroke-width="1.5" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <!-- Thoughts container (hidden by default) -->
                    <div id="openai-thought" class="thought-container hidden">
                        <details>
                            <summary>üëÅÔ∏è View Reasoning Trace</summary>
                            <div class="thought-content"></div>
                        </details>
                    </div>
                    <div class="ai-response">
                        <div id="openai-response" class="response-text">Waiting for response...</div>
                    </div>
                    <div class="ai-status" id="openai-status"></div>
                </div>

                <!-- Anthropic Response -->
                <div class="ai-card" data-ai="anthropic">
                    <div class="ai-header">
                        <div class="ai-info">
                            <h2 class="ai-name">Anthropic</h2>
                            <span class="ai-model" id="anthropic-model">Claude Sonnet 4</span>
                            <span class="sandbag-badge hidden" id="anthropic-sandbag"
                                title="Heavy reasoning detected in thoughts. The good stuff might be hidden!">üõ∏
                                Sandbagging?</span>
                            <span class="bias-badge hidden" id="anthropic-bias"></span>
                        </div>
                        <div class="card-rating" data-ai="anthropic">
                            <button class="card-rate-btn up" title="Helpful answer">üëç</button>
                            <button class="card-rate-btn down" title="Generic or unhelpful">üëé</button>
                        </div>
                        <div class="ai-meta">
                            <span class="cost-tag" id="anthropic-cost">$0.000</span>
                            <span class="response-time" id="anthropic-time">-- s</span>
                            <button class="copy-button" data-target="anthropic">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path
                                        d="M13.5 5.5H6.5C5.67157 5.5 5 6.17157 5 7V14C5 14.8284 5.67157 15.5 6.5 15.5H13.5C14.3284 15.5 15 14.8284 15 14V7C15 6.17157 14.3284 5.5 13.5 5.5Z"
                                        stroke="currentColor" stroke-width="1.5" />
                                    <path
                                        d="M3 10.5H2.5C1.67157 10.5 1 9.82843 1 9V2C1 1.17157 1.67157 0.5 2.5 0.5H9.5C10.3284 0.5 11 1.17157 11 2V2.5"
                                        stroke="currentColor" stroke-width="1.5" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <!-- Thoughts container (hidden by default) -->
                    <div id="anthropic-thought" class="thought-container hidden">
                        <details>
                            <summary>üëÅÔ∏è View Reasoning Trace</summary>
                            <div class="thought-content"></div>
                        </details>
                    </div>
                    <div class="ai-response">
                        <div id="anthropic-response" class="response-text">Waiting for response...</div>
                    </div>
                    <div class="ai-status" id="anthropic-status"></div>
                </div>

                <!-- Google Response -->
                <div class="ai-card" data-ai="google">
                    <div class="ai-header">
                        <div class="ai-info">
                            <h2 class="ai-name">Google</h2>
                            <span class="ai-model" id="google-model">Gemini 2.5</span>
                            <span class="sandbag-badge hidden" id="google-sandbag"
                                title="Heavy reasoning detected in thoughts. The good stuff might be hidden!">üõ∏
                                Sandbagging?</span>
                            <span class="bias-badge hidden" id="google-bias"></span>
                        </div>
                        <div class="card-rating" data-ai="google">
                            <button class="card-rate-btn up" title="Helpful answer">üëç</button>
                            <button class="card-rate-btn down" title="Generic or unhelpful">üëé</button>
                        </div>
                        <div class="ai-meta">
                            <span class="cost-tag" id="google-cost">$0.000</span>
                            <span class="response-time" id="google-time">-- s</span>
                            <button class="copy-button" data-target="google">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path
                                        d="M13.5 5.5H6.5C5.67157 5.5 5 6.17157 5 7V14C5 14.8284 5.67157 15.5 6.5 15.5H13.5C14.3284 15.5 15 14.8284 15 14V7C15 6.17157 14.3284 5.5 13.5 5.5Z"
                                        stroke="currentColor" stroke-width="1.5" />
                                    <path
                                        d="M3 10.5H2.5C1.67157 10.5 1 9.82843 1 9V2C1 1.17157 1.67157 0.5 2.5 0.5H9.5C10.3284 0.5 11 1.17157 11 2V2.5"
                                        stroke="currentColor" stroke-width="1.5" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <!-- Thoughts container (hidden by default) -->
                    <div id="google-thought" class="thought-container hidden">
                        <details>
                            <summary>üëÅÔ∏è View Reasoning Trace</summary>
                            <div class="thought-content"></div>
                        </details>
                    </div>
                    <div class="ai-response">
                        <div id="google-response" class="response-text">Waiting for response...</div>
                    </div>
                    <div class="ai-status" id="google-status"></div>
                </div>

                <!-- Perplexity Response -->
                <div class="ai-card" data-ai="perplexity">
                    <div class="ai-header">
                        <div class="ai-info">
                            <h2 class="ai-name">Perplexity</h2>
                            <span class="ai-model" id="perplexity-model">Sonar</span>
                            <span class="sandbag-badge hidden" id="perplexity-sandbag"
                                title="Heavy reasoning detected in thoughts. The good stuff might be hidden!">üõ∏
                                Sandbagging?</span>
                            <span class="bias-badge hidden" id="perplexity-bias"></span>
                        </div>
                        <div class="card-rating" data-ai="perplexity">
                            <button class="card-rate-btn up" title="Helpful answer">üëç</button>
                            <button class="card-rate-btn down" title="Generic or unhelpful">üëé</button>
                        </div>
                        <div class="ai-meta">
                            <span class="cost-tag" id="perplexity-cost">$0.000</span>
                            <span class="response-time" id="perplexity-time">-- s</span>
                            <button class="copy-button" data-target="perplexity">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                    <path
                                        d="M13.5 5.5H6.5C5.67157 5.5 5 6.17157 5 7V14C5 14.8284 5.67157 15.5 6.5 15.5H13.5C14.3284 15.5 15 14.8284 15 14V7C15 6.17157 14.3284 5.5 13.5 5.5Z"
                                        stroke="currentColor" stroke-width="1.5" />
                                    <path
                                        d="M3 10.5H2.5C1.67157 10.5 1 9.82843 1 9V2C1 1.17157 1.67157 0.5 2.5 0.5H9.5C10.3284 0.5 11 1.17157 11 2V2.5"
                                        stroke="currentColor" stroke-width="1.5" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <!-- Thoughts container (hidden by default) -->
                    <div id="perplexity-thought" class="thought-container hidden">
                        <details>
                            <summary>üëÅÔ∏è View Reasoning Trace</summary>
                            <div class="thought-content"></div>
                        </details>
                    </div>
                    <div class="ai-response">
                        <div id="perplexity-response" class="response-text">Waiting for response...</div>
                    </div>
                    <div class="ai-status" id="perplexity-status"></div>
                </div>
            </div>
        </section>
    </div>

    <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>

</html>